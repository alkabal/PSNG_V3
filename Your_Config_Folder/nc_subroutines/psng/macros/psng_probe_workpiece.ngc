o<psng_probe_workpiece> sub

;  o<psng_load_var_touch_probe> call

  M160    ;o<clear-axis-info> call
  o90 if [#<_hal[probe.blockheight]> LE 0]
      (ABORT,BLOCK HEIGHT NOT PROBED/CONFIGURED)
  o90 endif
  
  (cancel Z offsets But force use tool offset)
  G43          ; force tool offset for correct calc
  G10 L2 P0 Z0 ; reset G54 offset for correct pieces measurement and replace by new value
  #<intial_Z>=#<_z> (save current Z position)
  
  ;o<backup_coord_offset> call             ; new added 2021 but removed here 2022       ; backup G54 offset for correct calc tool measurement
  
  o<psng_start_z_probing> call            
  o500 if [#5070 EQ 0]
      (ABORT,PROBE FOR WORKPIECE HEIGHT DOES NOT FOUND THE CONTACT POINT)
  o500 endif
  
  (print, probe Z=#<_psng_touch_result_Z>)
  
  ; "G10 L2 P0 Z%s" % blockheight is done inside python code due to multiple possibility for set workpieces height
  
  (back to start point)
  G1 Z#<intial_Z> F#<_psng_vel_for_travel>

o<psng_probe_workpiece> endsub
M2
